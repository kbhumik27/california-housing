#!/usr/bin/env python
# coding: utf-8

# In[1]:



import sklearn

import streamlit as st
import pandas as pd
import numpy as np
from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsRegressor
import time  # Import time module





california_housing = fetch_california_housing(as_frame=True)
df = california_housing.frame

# Create a Streamlit UI
st.title('California Housing Predictor')
from PIL import Image

image = Image.open("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAJQA3AMBIgACEQEDEQH/xAAcAAABBQEBAQAAAAAAAAAAAAAEAAIDBQYBBwj/xABOEAACAQMCAwUEBgMKCwkAAAABAgMABBEFIQYSMRMiQVFhB3GBkRQVIzKh0ULB0hYkM1JicpKx4fA1U1VkdJOUoqOywhdEY4Szw9Pi8f/EABkBAAMBAQEAAAAAAAAAAAAAAAECAwQABf/EACYRAAICAgMAAwABBQEAAAAAAAABAhEDEgQhMRNBUSIjQmFxoRX/2gAMAwEAAhEDEQA/ANYwUetM5fIVNyeOKcFFelvRBRsHMZIrnYHzonFcyKG4/wAaBWiANMZBijeVTUToKZTsWWNJdAhWuYqRlOabg1VMg0cWEt0/Gk0DL5U9T5nFPDAHcZoWwpRogWHO9OEAotWiIyV3rrrkdxqXdlVjjQEUC7Uw4HrUsgOdzmoiKoiMnQwt5U0mpAmacIcjfFG0L2yILzHFPMeBUigJ0FdJBoOQ6iq7IQldCCut12rgDUbAdxT1G1IIT0FSgYFK2OkRECkFp/LvmlihZ1DaQXNPBX1pwxRsFIYI6XZ081wmgmGkG5pjPg07YVzI8qzljgbNdYDwpwIxS7ppbKJdEdcKk7VLyjwNc5W8KNg1IjFmozGR4UagJ+8vxrhAz0orILLEqsC7M+Nd7MjoPlRnIQN13pBXPQbU+5NwSAxGf4pqRAVGBRQiY10QV24Na8AWjya6IM0d2GPCumPA6V252q+wDsgoqJ1NHuhqIxUykBoCKmmEGjGXFRlCadSEoF5TT42K+Gan7HIzmudkB41zkgqLQlkcjHLgVw8x607lHTmOKaVXPiffSlHY3Bx61zBp4ZR90YprPmj2K6ObikSaWTXKZIm2Ik1zJpUqILLRgc+lLsvKu8mT0qaJeXf8K8+UqXR6EYbPtESwnyNdMBPn86IaRvDGKj7RvIVNTkyrhBEYgI6mu4YdOlPMjeVdCljvTW/sW4+Ijwacsb+QqZY/KiI4j40dkhWmwdImPWplgolIwKlAA8Kk8gdEC9jThb+lFqATjlqv1rWLXSIx2xLzv9yFPvH1PkPU/rpoyk30JKKRKbb0phgrA2HtBmfXpomuoJwDg2agAKP5DdSw8ck/Dw3tvq+nXVqlwt0iq7rFiQ8rK7bBSPMk7edVcZRXZNNMjeH0qEw+lWzxLjJqFkUUqyHalcbZMZPWo2gUfdqxMYIyKieLFNsxv4/hWPFiojHVkyY8KiZc+FOpAaTK8xnyphUjwo9oj4CmGJvdVFMRwASvpXOWi2jPjUbJTqRNxB+WkVqUimmmTEcSPFcxUmKbijYupe5U4rpKDxqMjypBTXk9M9js6WBNIJT1SpkjptkibtkaRZohYgKkSPapAvpU5SbGXRGIxUix08L6U8LQQHIquIdSTRtEvdQbH73hZ1B8WxsPnivF/wDtZ4nVcn6uOOv73P7VbX21X8selWWj2yPJcX03N2calmZUxsAPNio+dYW30PTOGIY9R4qZZrwjNvpykHfzbz/qHrWvFCKhciE5O+jU6FxnxbeWzahqkunafpijPbvbkM/80FunqdvLNYvWuK59a1EW9m0q288yrJcMe/JlgPgN/wD8qv1vWNQ4kuBJqEgjgQ5jto/uIPDPmfD8qjgRIZYJAAezkV8eeDmqxivpUTlL9Nxc8KafELqOK0ije3jZ1lVcMCoyDmqbhPjDleC31tijo6NDeIM4ZSCvOPHfx+fnV2eMG1OWS0s9Hme7uUZAFmB2IwSe70HnVSYdL4IjU3PZahr+O5AD9nbnzPr6/LzppCJl3xBxjxxpINwTavYlu5cCzIIHhzLnK/GqD/tV4pPWWyB/0UfnQOncXaza30t1dyLewTfw9s690jyXyo2+4Y0/iG0k1Tg+XLKMz6c5wyH+T+XTyNCLj9oZ39G19l3F+q8R31/Bq0kLCKJZI+ziCdTg/qr0QqDXzdw9xBqPCl7PcWMcS3BXspEuYycb9OXIINaVfatxMRkDTR/5Zv26E8dy6CpddntDRZ6Comix4Vi/ZtxrqfEeqXlnqwtu5AJIewjKZIODnJPmK9AdPQ1J7RdMNIryh8qjaM0e646jAoeQqOpoJsNATR1E8dHKUcnDZx1welNaP406kK0VzR1GY6OeOomSqqRJgvJXOWiChrhQ02wGg3GKcoOelTCKpEiryT1LRHGD5USgp8cNTrEKDO2X0VOv6rDoej3epXRxHbxlsH9I+C+8kgfGvn1+KeIJp5Jfri9TtHLlFmPKuT0HpW69tOudtdwaDbN3IcTXOD+kR3F+W/xFeaJHvn+utvHx0rZDJLstk4l1/wDyzf8A+uNG6PqfFOs6hHYWOs3RmfJy9wQFUdT61RrF6CkQ8bK6OVdN1Kkgg1dpE7N3daoukyi3sZ5Na1lB2c17cPlYB1Kr1x7h8TRdpaK5a5n0lL64l3Z50BJ8u9k9Pd8qE9m9ok+kXksgHMLor5YHItbie1m7C1WC4mjUIciNyPE+tQzZo4MW8kdCDyT1iU30dI0ATQ7NiRgk2wUL69Tn3be+k0XaXCW1vpOnRswLmaWEKqKOuF/S6jx/s2Oj2jfQz2skjHmO7NkmqbjTS4ryKKKRQy4YHm8QcZ8anx+ZDPKooOXA8fbMpLrdukz2vDdskjP3bi/jULnH6KDBGP77nerLS7W6SL/B4KseYy8oZ3PqSmD5561zQtHt7LT444VwAz/d2H3jR+t2l20OnS288scEYIlCSEc2SceNXz5Y4ce8ieODyz1iOCXxJzpwCDxWNeY+/wCzx8qBvYr+KZZvoy27r/BtGAp265PJv7unpWq0m0AsF5ndiC3eY5J/Gmarb4igA5jgncVn4/MjmdJFs3HljVtnn+twaTxG8Vrroj0vWZsrbXafcnxjAbp5gY+R8K86u7JrC9ntHkjlaByheJuZSR5Gtp7WI+yutFdRhl7dhnzBjxWMgTbf35PWtUXTI1aOBTjGK44JG5NFCL0FNaMVZCtFdJGvlQ7oo6qPlVhInzp82kahHpS6q9pKti7cqzle77/d69KN0JX4XHsu1ldH4qgjchbe9+wl8ACfuN89via9/EbEZ7vrXywocOvZ5Mme5y9c+GK+kOBdUutb0Zbm8ijjZQqd18ksFHMSPDc7elZeQ6aZXH2iyeKoGiqzeKhrpobaJpriVIol+88jBQPiamsgXCwLsqXZelVOpcVWVrA0tsnbRY2nlfsYf6TfeH80GsPe+0YLcMF1OTHla2StGPcXcE+/Fd8g3wnr4GPCpEx5VIEGOoHvNctpoJ/4KQMPAgbHr0Pj0rC5I1UyVMeRoXWNSg0nSrnULg4it4y5z4nwHxO1HhcdDXlftn1wH6NocL53E9wM/wBBT+LfAVTFHeVCvpHmV/czahf3F7c7zXEjSufU/wB8U1Epq1OoFerGJlbEqUyRfSiVUf3FNZctiucQJm/9l6D6juwSqk3ZOCcfoL+VbcmJ4ovtYgVXBy48z614SycwGfD1qIxDO2fnUsvHjljrLwMJuEton0Ra3lvBF2bSKSTnusv50DrU0Nx2ZjcbZ8R+deB9kR0z76YY5D1Zvmalh4mPC7ghp5JTXZ7jbRqLdMN59D6++itQt5rmwhjtu9jBbf1rxK11fWLKBYLTU7iGFM8qK2wyc+NTjiHXsgfW90cfyh+VPyOOs+PR+C4pPHPZHudqJoLUIAvNk5DHpXL7LwwB/vgkkLXiC6/rv+Vrz+n/AGU8a7reSfra83/8Q1n4/AWCe6k/9FcueWWNNIuva+g7bRj07s//ALdYmFNqtry6u9R5Tf3U1yYweQzSFuXPXGfcKr7bcZIxtW3V2S+iRVGOlII0jqkSM7scKijJJ8h61Y6TpN5rF0ttp8JllO58Ao8yfAV6RpPDtvw/HyWC2t5rrDl7eclY4v5uAfzPpTOSSBRltL4WstDig1Diwq0kpAttNXcuxOBzefu6DxrQ3Vzq8d5cTSCGW0SEh7AoOTkA8DjOd/d6Cg34O1a7vjqd3qlpcXIYMZGZ+6cjAAxsNhsKuLu14kngdXvtH5JVKk8r5PnU7bAYCfhnT9ah+vOD5XKR9+SwG0kTegPT3fI1ovZXq7WmvXOlXGUivBzQjAAEiLuOvUqCcfyTVNPo0ug3EX0S8tIrwsImkgLDbbAY8owNgD16mgbabs76KeRpfrS3uhLbSWwHZhuYbMSc4OfLxrzZZ9stPoaPR9AFcjpUM0CSo0cqBkYYKkdRS069ivo8r3JVH2kLfeQ/l60QRRbadGhJHnXtA4Z0e3sItU+gK88VxHl2cksufu5JO1Y+1KWkCRR21jygD78XMennXp3tEh7XhtgDj7ePx9a84k05i55FOPMLnNMrLwrXs3vEerpbuzhZgkAK9ouSAxwfdnbY+lYPQeKe1ubDtb+VUuIiJjchmXmRjyFOuCS2D6VL7RNfFwF0yzd76yl7s0nKRl9yArYAJGN9/h1rznTLk2WqWs0xePsZuYd0HsvUBs9OtJLAgbn1HpM7XOnW003KZJI1LFc8pONyAfCvKuN+EGtRca9qs09w15dY7O2dcrkEj7wxgKoHXwrQ6JxzotjpthbJLc3UKKqPcuoU+TOQTk97PQdKXEPE2j8R2/1Zpkss8lvKJHYxFEwCV2Jxnc+FV4yf0SyS6MUvCVgj4kTUFbAPK1xCDRcfCumbZW9/2mH86g9pthHNr9srcyj6OpypwTuaoLbRoUaNw8p5MYy/X31r/qWZ3qa9eF9KA/g7z/aofzqe14f0e3k5jp812T3RHNcofiOUg1kpdMimbmZpF2xhW2qy4R0qG04isHR5WYyAYdsjxNF7g/iaVeHoprx4oND05U5yqmV5s48MjmpraDZqSBb8OjHXmklz/wA9ej2tpasYZGVzN1BD9PhXj+o6bb3Ov3XMCM3D5Ax5mpQnvf8Agdqi3+o7T/EcOfOQ/wDVTfqS18YeHPm/7VVEvD1vb/SSOdjOqqxZs4wMZHlVcnDdsjK3PMSviXB8MeXp86ZNvw5qjTnQ7T/FcN/Jv2q6NFtR+hw1/Rb9qqKbS4pggfmHLndcLnIx0AxTotDtvpkdyqvzopXl5u6dsZI8TReyOVMvRo1rnpw3/q2/aqdNBSSOR7a24fn7MZIjgY/jms7NwtZANOTMpYk4EmwJx0+Q/Gtj7NbG0s7fUk75iyrtzPk5yfHapuTS2Gr6KxtGuQVC6PoJzksGiKgCh04aSNP8G6MPP7SX9utBx1NbW9tprW11LZW5uhHLMG5SF5Tncg/OqLSL8T8Q2dtZaxPeW8ltMZVaVXAYAcp2UY6mvNzZOU3vilSNMFhj1Ndhqi80+zi0/TDY6eLqaPtHRGBIOFIVwTk9cc2MZxkVBxLfQcMS2lp9CN4s6c4IfAG+PGrlIjPDpc8qMJDPEWDdc8wrnGunC91OzJAKxxn+sU/B5GbLhcpPtMGbDjWRJeMGh1DtWV305kIyFbmzj8KIukuI1E0VkheXYN2nxqa7C295ImNucAb+YNTapE8tt9ncFOz73IMHmPkc5rxv/Z5PyuMvDVLh4VBNLs8712/55pJDCYxKQDFsx3GP6wD08qpo7UaiXYRS/ZpiTB5uQnYbdQc9K0uo2arcTtFlezcFeYAMr4HX4n3VHoiXEVu7yyCGEzc3ZkrhpRupY9cAePoBWvBLaVs82caN9wzoq2Gn2l3LdX108Abl5lUOw8jg7/E5896H1XjO4SBp7S1trSDoLi/uAoz4d0H8KZb8eSzS3f0ax+kmKNBEkDAo8hG55tttx5+lZr2k6nc3/DF4LvT44GglQiSF9iNtvPzr0VLaisaRT8Q8S6rqCAJxGs2d+xto3jjA8w3KM/M1kpXuJJGIvZDuR3yzf3FbTXLV5tOhaCKNYbePmGNmxIQfj6CsVdWb9rskgXHdxtt8jWvHG0Zs0qZoeKZ9Rh1mK3a8ZxBEsyNK6sQSDk7+vp41lhbSzXhlmVZixJZWlUdPXNerXeo6dcTF4dKnvpjhCwhxgDGNztWck4jsbKYLJYafGuXUtJ3iuGbAOB1x4elGeVP6LRxyKKXCwWyw2lsMozECRf4x269K0nBjK15cwi2t05I1+0jxzN3hsceFWmm6lpN9pkN5cWJbJIzawZUD0GCT8PWi9MbS4wfokgE3KpkV1CkAkegPzpcU+6r0WeN1ZWe0nA4jgH+ar/W1UkbAAVa+0qVf3TRcrKR9ETpv+k1UCXGwwRWuJFsPDj1+VWXDR5uItPXzm/UaofpQ8WHzqz4VuUPE2n5ZeUSEnfyU078Evs9F/dno8N0FkmuQ6MV5exYAY264rFXZ5NdvPNbmT/mNUlzfRHWbyEFlk7dudSMg7k5B+XiKs9Un5df1Ecyki7l/5jUMcV2Vm/CymcuuaHIqD6Y2NghrhuznotNFUdJ2EctSxjBG+KEW6z4L+NSLdfzDRYIsNumUwYzvR/DGq2+j2moT3bSLFI0aZQZOcE1STXfMmDyfOmTFpeHb/s8FkkRup8m8R+dTaWo13If7SOI7DV+H4FspJ2KXIOZExnY9DWe9mUoPFcPOWz2EgXf0FA3UNxf6ZHbW3ZFzIHVWlRO7v4t+dH8EaXd6XxDBd3xtY4VR1ZvpUbYyNtgaRygsTjZ3xyedSS6PVLu4S3SCWTnZYpFYjG5xvtUVzqttqsiyWySELCrZYAZ5xkePlQGp6jZzRLGt3C2WOeSQE9DQOkXVtE7KbiIDsIV77gbhem58PGsvGxpQaX6bMze6Z57xZq2tXWs3KSXFxMfpDCERK0e2WwAABn379PfWw9nkuuTQzJrPaxxxqoge5Ug7Ag7Hc+FX95qthFLaCa4tWMk3KrGVe4eU+u3l8aNN/aqCTd2wGf8AGj86XLw8OWOs10BZZrxlVrti1zfTXFvHIInHfRTnLYHexnpkVQ3EFtZW80OoreMzqQVtcBT4bkjYb1rW1KzIyL22IPlMp/XWO4nu45tdM0D9qsMMZkRX8OUN0Ho1dHiYou16yErfpo+FoL690yHkeyggjPZmFoA3aHG5Y+P9lV3tJsbq14SvXuJrWQMyfwMIQ7HbOKg0rj3RrbJk5EYtk8gYHx8DQ3GXFekcRaJJp8N00JdlPOYy2wPlU8clFqNf8GbSfXg7Vria2iQOnPG9ujgAYGwHz8PdWRlnKTSCSEMebrzn861cmt6PeaZBG18I544wpV4W72Fx5HrWJ1GLku37NldDurJuCPSt+OTSI5YX2TaXql1p2vXF1iSS1kZmVZX5sjwyAf74qzlub7iyH6rSye55pDIotoApUkkkknp1PiK9S0zhnUdMn+kQWlq02/2kuoTOT89vwq3jj15pSZbPTpEI+40rMc+80qquymzMdw77MtRktoYdUu3tLeNcLDHys3zxjPwq74l4X0nQ+GkjgtldmmXmlkAL+OMk+FaMW2qmHC6fZK/gRORj4YoS5XWYLbN1b2zjw7OQ5H4b0Yv+SFbPKeLUt4tWijVDHEsCgKqDbc1W2/0FmPbCTl8OVACa9B1HUiswWY3UON2WGLIPzUn8aHl1q2ZSFaYDwPY7j/drSifZi0jspJxHGnMCdu6M4q30G205tRghS1WdXJRpOzyACpyM/rq3j1YRxFYJPtm6zNYsx+XSjNF1G9e4HLdyStndGtuQH/d2pZdIaJkE0jTZrmZmlhjTtG5FIAbYnwzROpRJ9dXgjCkGZjnrvnpW5Gn60ZnmnvU7JmzyJGi49MlTmqfUb2N7mSNngVuYllMPPv78Cs2Kfb7LzVozpgnC5dFC+i1wW6ucEk58gBWhhlYRlVe2wep7A/tUJ9IaJmL3sK4OxW3BNaFJMk0yqW0btMRr+IrsiyA8rRLzDybFWDahDzAyX7nzxBj9VSC9tZAqw3TqMYx2Wcn12pmKrKd3VV78HU7Zb+yrK0sor3SLuNoFDB0JWQgjODijbZ5QSIrkFT0zBuPwq/0yK+aAqh5ySCHKoOnpy1nzSqLLQ9MfZ8OPZabcXiWZETDchlUnHjtviq9dT7GUNBKqMBjBm5vwNby9sNZyGM0CpnvRPEpVh64xVdJpk6SMba30sKenbW3aMPkwrBLFObHyN/2sx8usXHP3r5cdSvaKpqrZIOYtHqE8fNuVS7FbeXTLsN9oujr7rBt/+JTV0mfcM2nMT0/eTjH/ABKK42ZeEG5fbMdJa2N6wmu9WvWcHPP9IBIPmMnA+QouO109Pv8AE2pAn+PdLv8AjWrXQ7glio00ZxjNkxx/xK6NIu4lIf6pz5iybp/rKf4s3gU5fplotN0jkKfuov4hvsZwR+BqK70zSpL2Sc6wQ7YQ/b8nMqjkXx8gKsrzhxpLl5XvLTLHOBaPj/1KIsOE55nAt1snJyTzRzf/AC0fhzsDbZmvqLQScNfRls9Tcg702XhzQWb/AAjysD0Eq4r0mLhDiEBVVdNWMDAAtM/iZM1L+5TWlzzCwPX/ALucD4c9I4ci/RKf6eXLw7pGMpqUYx/GuV3+GajbhsSEMNYtQMbAsGIHwNemXXCur7NHJpyEf5sT/wBdCHQtdyea9sc/6L/96ZQ5X6c7/T02cBMcqj5VEHI6YHwpUq1UUHGZwMg4921DS3MhPKTkYpUq5AYF99yGAO/lTXhUdCaVKrRYrImbl7oA99SxjL4yQB5GlSoy8Oj6WALchHMcAeQrL6o376IKqfeM0qVZsaXZqk+iRIIuwB5FyR5VT6zFHFAzoigg52FKlVcSRKTZmnuZjgc5AydhVrp55gpO5pUq2Pwgi9ijBUHf4VZ2kXKRyu49c0qVZsnhWD7CZ1ON5HO3iaD8OpNKlXYoqhZtjQM7Hwp5iTl5sDNKlWmlRC3ZCzegqEnn60qVI0qHj6Ul3dSRXHKoXB8xVxYwR3MamVd8fokilSpV4NL0Nl0O15TiS5GOmJiKUGjwwyx9ncXY59z9sTSpVwAxw8Q5e2dx/Kx+VRdq/n+FKlRAf//Z")
st.image(image, caption="house", use_column_width=True)
# User input
user_input_neighbors = st.sidebar.slider('Enter the number of neighbors', 1, 10, 3)
user_input_population = st.sidebar.slider('Enter the Population', 0, int(df["Population"].max()), 1000)
user_input_bedrooms = st.sidebar.slider('Enter the Average Bedrooms', 0, int(df["AveBedrms"].max()), 3)
user_input_occupancy = st.sidebar.slider('Enter the Average Occupancy', 0, int(df["AveOccup"].max()), 3)
user_input_rooms = st.sidebar.slider('Enter the Average Rooms', 0, int(df["AveRooms"].max()), 5)
user_input_age = st.sidebar.slider('Enter the House Age', 0, int(df["HouseAge"].max()), 20)
user_input_income = st.sidebar.slider('Enter the Median Income', 0, int(df["MedInc"].max()), 4)

# Split the data
X = df.drop(columns=['MedHouseVal', 'Latitude', 'Longitude'])  # Exclude Latitude and Longitude
Y = df['MedHouseVal']
X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=42)

# Scale the data
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# Create the model
regressor = KNeighborsRegressor(n_neighbors=user_input_neighbors)
regressor.fit(X_train_scaled, y_train)

# Create a dataframe for the user input
user_input_df = pd.DataFrame({
    'Population': [user_input_population],
    'AveBedrms': [user_input_bedrooms],
    'AveOccup': [user_input_occupancy],
    'AveRooms': [user_input_rooms],
    'HouseAge': [user_input_age],
    'MedInc': [user_input_income]
}, columns=X.columns)  # Ensure columns match training data

# Scale the user input
user_input_scaled = scaler.transform(user_input_df)

# Display a loading spinner while the prediction is being calculated
with st.spinner('Calculating...'):
    # Simulate a delay (remove this in real app)
    time.sleep(2)
    
    # Predict the median house value
    predicted_med_house_val = regressor.predict(user_input_scaled)

# Print the predicted median house value
st.write(f'The predicted median house value for the given inputs is: {predicted_med_house_val[0]}')

# Print the longitude and latitude
st.write(f'The longitude and latitude are: {df["Longitude"].iloc[0]}, {df["Latitude"].iloc[0]}')




# In[2]:




